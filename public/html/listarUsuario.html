<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="UTF-8" />
    <title>Lista de Usuários</title>
    <!-- Importando o CSS do Bootstrap via CDN -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />

    <link rel="stylesheet" href="../css/styleAdm.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap"
      rel="stylesheet"
    />
    <!-- Importando o JavaScript do Bootstrap via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </head>

  <body>
    <header id="cabecalho">
      <h1><a href="./areaAdm.html">Área Administrativa</a></h1>
      <nav id="menu">
        <ul>
          <li><a href="./index.html">Cadastrar Veiculo</a></li>
          <li><a href="./novoUsuario.html">Novo Usuario</a></li>
          <li><a href="./contato.html">Contato</a></li>
        </ul>
      </nav>
    </header>

    <div class="container_adm">
      <div class="adm">
        <h2>Lista de Usuários</h2>
      </div>

      <table class="lista">
        <thead>
          <tr>
            <th>Indentificador</th>
            <th>Email</th>
            <th>Nome</th>
            <th>CPF</th>
            <th>Cargo</th>
            <th>Opções</th>
          </tr>
        </thead>

        <tbody id="tabelaCorpo">
          <script>
            // Função assíncrona para carregar os dados da API
            async function carregarDadosUsu() {
              try {
                // fazer a requisição para a API
                const responseUsuario = await fetch(
                  "http://localhost:3000/listaUsuario"
                );

                if (!responseUsuario.ok) {
                  throw new Error("Erro ao buscar dados");
                }
                // Converter a resposta para JSON
                const dadosUsu = await responseUsuario.json();

                // Obter o corpo da tabela html
                const tabelaCorpo = document.getElementById("tabelaCorpo");

                // Iterar sobre os dados e criar as linhas da tabela
                dadosUsu.forEach((item) => {
                  const linha = document.createElement("tr");

                  // Criar celulas para cada coluna
                  const celulaId_usuario = document.createElement("td");
                  celulaId_usuario.textContent = item.id_usuario;
                  linha.appendChild(celulaId_usuario);

                  const celulaEmail = document.createElement("td");
                  celulaEmail.textContent = item.email;
                  linha.appendChild(celulaEmail);

                  const celulaNome = document.createElement("td");
                  celulaNome.textContent = item.nome;
                  linha.appendChild(celulaNome);

                  const celulaCpf = document.createElement("td");
                  celulaCpf.textContent = item.cpf;
                  linha.appendChild(celulaCpf);

                  const celulaCargo = document.createElement("td");
                  celulaCargo.textContent = item.cargo;
                  linha.appendChild(celulaCargo);

                  const celulaOpcoes = document.createElement("td");
                  celulaOpcoes.textContent = item.opcoes;
                  linha.appendChild(celulaOpcoes);

                  tabelaCorpo.appendChild(linha);
                });
              } catch (error) {
                console.error("Não foi possivel carregar os dados:", error);
              }
            }
            // Chamar a função para carregar os dados quando a página for carregada
            document.addEventListener("DOMContentLoaded", carregarDadosUsu);
          </script>
        </tbody>
      </table>
    </div>
  </body>
</html>
